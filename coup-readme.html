<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
    <meta charset="utf-8">
    <meta name="generator" content="quarto-1.4.550">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
    <title>coup-readme</title>
    <script src="coup-readme_files/libs/clipboard/clipboard.min.js"></script>
    <script src="coup-readme_files/libs/quarto-html/quarto.js"></script>
    <script src="coup-readme_files/libs/quarto-html/popper.min.js"></script>
    <script src="coup-readme_files/libs/quarto-html/tippy.umd.min.js"></script>
    <script src="coup-readme_files/libs/quarto-html/anchor.min.js"></script>
    <link href="coup-readme_files/libs/quarto-html/main.css" rel="stylesheet">
    <link href="coup-readme_files/libs/quarto-html/tippy.css" rel="stylesheet">
    <link href="coup-readme_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
    <script src="coup-readme_files/libs/bootstrap/bootstrap.min.js"></script>
    <link href="coup-readme_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
    <link href="coup-readme_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
    
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script><script src="coup-readme_files/libs/clipboard/clipboard.min.js"></script>
    <script src="coup-readme_files/libs/quarto-html/quarto.js"></script>
    <script src="coup-readme_files/libs/quarto-html/popper.min.js"></script>
    <script src="coup-readme_files/libs/quarto-html/tippy.umd.min.js"></script>
    <script src="coup-readme_files/libs/quarto-html/anchor.min.js"></script>
    <script src="coup-readme_files/libs/quarto-html/plotly.js"></script>
    <link href="coup-readme_files/libs/quarto-html/tippy.css" rel="stylesheet">
    <link href="coup-readme_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
    <script src="coup-readme_files/libs/bootstrap/bootstrap.min.js"></script>
    <link href="coup-readme_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
    <link href="coup-readme_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>
    
    <script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>
    <script src="coup-readme_files/libs/quarto-html/plotly.js"></script>
    
</head>

<body class="fullcontent">
    <div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
        <main class="content" id="quarto-document-content">
            <section id="behind-the-scenes-guinea-bissaus-latest-coup-attempt-is-only-one-of-10-since-2000" class="level1">
                <br><br>
                <h1>Behind-the-Scenes: ‘Guinea-Bissau’s latest coup attempt is only one of 10 since 2000’</h1>
                <br>
                <p><em>Outlining the data collection, analysis, and visualization process for the story <a href="https://tejalwakchoure.github.io/coup/">Guinea-Bissau’s latest coup attempt is only one of 10 since 2000</a>.</em></p>
                <br>
                <p>After the assassination attempt on President Umaro Sissoco Embaló in February 2022, I started digging into the history of political unrest in Guinea-Bissau and the impact on its economy.</p>
                <section id="data-analysis" class="level3">
                    <h3 class="anchored" data-anchor-id="data-analysis">Data Analysis</h3>
                    <p>I pulled data on attempted coups from the Cline Center for Advanced Social Research’s <a href="https://clinecenter.illinois.edu/project/research-themes/democracy-and-development/coup-detat-project">Coup D’état Database</a> (H/T to Jeremy Singer-Vine’s <a href="https://www.data-is-plural.com/">Data Is Plural</a> newsletter!). The database contains nearly 1,000 coups, each with details such as the date, type of coup, source (military, popular revolt, etc.) and outcome (resigned, arrested, exiled, injured, killed). </p>
                    <img src="coup-database.png" class="img-fluid">
                    <p class="small" style="color: gray;margin-top: 10px;">A snapshot of the Coup D’état Database</p>
                    <p>I pulled the dataset into Excel for analysis. It details all coups worldwide from 1945 to 2021, so I grouped all attempted coups by country and year to chart global political instability over time. Some of my initial visualizations included charting the number of coups by year. </p>
                    <img src="line-chart.png" class="img-fluid">
                    <p class="small" style="color: gray;margin-top: 10px;">Initial explorations</p>
                    <p>However, because I wanted to zoom in on Guinea-Bisseau, I decided to process the data geographically instead. I switched to a choropleth map to keep the narrative structure consistent with the rest of the story.</p>
                    <p>I created unique keys for each attempted coup in Guinea-Bissau based on its source and outcome. Once I extracted the rows I needed, I went digging into local news coverage to confirm that these dates mapped to significant political unrest.</p>
                    <p>Perhaps the most interesting fact I found was that only one elected president in Guinea-Bissau had ever completed a five-year term in office since its independence in 1974. A lot of local coverage talked about the drastic effects of the attempted coups on the economy, so I collected GDP and military spending data from the <a href="https://data.worldbank.org/country/guinea-bissau">World Bank</a>. </p>
                    <img src="guinea-bisseau.png" class="img-fluid">
                    <p class="small" style="color: gray;margin-top: 10px;">Contextualizing attempted coups with annual percent change in GDP</p>
                    <p>Using basic statistics, I converted the GDP numbers to year-over-year percent change. I went in with the hypothesis that both successful coups (in 2003 and 2012) would have led to a drop in GDP — but I found that the 2003 coup led to an <em>increase</em> in the annual percent change in GDP. I’d be curious to see if this is a common outcome of coups welcomed by the public.</p>
                </section>
                <section id="data-visualization" class="level3">
                    <h3 class="anchored" data-anchor-id="data-visualization">Data Visualization</h3>
                </section>
                
                <section id="making-an-interactive-choropleth-map-for-global-coup-data-using-plotly" class="level3">
                    <h3 class="anchored" data-anchor-id="making-an-interactive-choropleth-map-for-global-coup-data-using-plotly">1. Making an interactive choropleth map for global coup data using Plotly</h3>
                    <div id="71cc6fc2" class="cell" data-execution_count="1">
                        <div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python">
<span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> plotly.express <span class="im">as</span> px</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>coups <span class="op">=</span> pd.read_csv(<span class="st">'coups_all.csv'</span>)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="co"># coups = pd.read_csv('coups_2000.csv')</span></span>
                        </code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
                    </div>
                    <div id="fb63674b" class="cell" data-execution_count="2">
                        <div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python">
<span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> plotly.graph_objects <span class="im">as</span> go</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> go.Figure(data<span class="op">=</span>go.Choropleth(</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>    locations <span class="op">=</span> coups[<span class="st">'code'</span>],</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>    z <span class="op">=</span> coups[<span class="st">'COUNTA of coup_id'</span>],</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>    text <span class="op">=</span> coups[<span class="st">'country'</span>],</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>    colorscale <span class="op">=</span> <span class="st">'plasma'</span>,</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>    marker_line_color<span class="op">=</span><span class="st">'gray'</span>,</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>    marker_line_width<span class="op">=</span><span class="fl">0.5</span>,</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>    colorbar_title <span class="op">=</span> <span class="st">'No. of Coups'</span>,</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>))</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>fig.update_layout(</span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>    autosize<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>    height<span class="op">=</span><span class="dv">500</span>, <span class="co">#1000 for actual map</span></span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>    template<span class="op">=</span><span class="st">"plotly_dark"</span>,</span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a>    margin<span class="op">=</span></span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a>        {</span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a>        <span class="st">"r"</span>:<span class="dv">0</span>,<span class="st">"t"</span>:<span class="dv">0</span>,<span class="st">"l"</span>:<span class="dv">0</span>,<span class="st">"b"</span>:<span class="dv">0</span>,</span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a>        <span class="st">"pad"</span>: <span class="dv">0</span>,</span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a>        },</span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a>    title_text<span class="op">=</span><span class="st">"Number of Coups"</span>,</span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a>    title_font_size<span class="op">=</span><span class="dv">14</span>,</span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a>    title_xanchor<span class="op">=</span><span class="st">"center"</span>,</span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a>    title_x<span class="op">=</span><span class="fl">0.5</span>,</span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true" tabindex="-1"></a>    geo<span class="op">=</span><span class="bu">dict</span>(</span>
<span id="cb2-27"><a href="#cb2-27" aria-hidden="true" tabindex="-1"></a>        showframe<span class="op">=</span><span class="va">False</span>,</span>
<span id="cb2-28"><a href="#cb2-28" aria-hidden="true" tabindex="-1"></a>        projection_type<span class="op">=</span><span class="st">'equirectangular'</span></span>
<span id="cb2-29"><a href="#cb2-29" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb2-30"><a href="#cb2-30" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb2-31"><a href="#cb2-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-32"><a href="#cb2-32" aria-hidden="true" tabindex="-1"></a>fig.update_layout(</span>
<span id="cb2-33"><a href="#cb2-33" aria-hidden="true" tabindex="-1"></a>    paper_bgcolor<span class="op">=</span><span class="st">'black'</span>,</span>
<span id="cb2-34"><a href="#cb2-34" aria-hidden="true" tabindex="-1"></a>    plot_bgcolor<span class="op">=</span><span class="st">'black'</span>,</span>
<span id="cb2-35"><a href="#cb2-35" aria-hidden="true" tabindex="-1"></a>    geo_bgcolor<span class="op">=</span><span class="st">'black'</span>,</span>
<span id="cb2-36"><a href="#cb2-36" aria-hidden="true" tabindex="-1"></a>    legend_title <span class="op">=</span> <span class="bu">dict</span>(font <span class="op">=</span> <span class="bu">dict</span>(color <span class="op">=</span> <span class="st">"white"</span>)),</span>
<span id="cb2-37"><a href="#cb2-37" aria-hidden="true" tabindex="-1"></a>    dragmode<span class="op">=</span><span class="va">False</span>,</span>
<span id="cb2-38"><a href="#cb2-38" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb2-39"><a href="#cb2-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-40"><a href="#cb2-40" aria-hidden="true" tabindex="-1"></a>fig.update_traces(</span>
<span id="cb2-41"><a href="#cb2-41" aria-hidden="true" tabindex="-1"></a>    colorbar_orientation<span class="op">=</span><span class="st">"h"</span>,</span>
<span id="cb2-42"><a href="#cb2-42" aria-hidden="true" tabindex="-1"></a>    colorbar_thickness<span class="op">=</span><span class="dv">10</span>,</span>
<span id="cb2-43"><a href="#cb2-43" aria-hidden="true" tabindex="-1"></a>    colorbar_yanchor<span class="op">=</span><span class="st">"bottom"</span>,</span>
<span id="cb2-44"><a href="#cb2-44" aria-hidden="true" tabindex="-1"></a>    colorbar_title<span class="op">=</span><span class="st">" "</span>,</span>
<span id="cb2-45"><a href="#cb2-45" aria-hidden="true" tabindex="-1"></a>    colorbar_len<span class="op">=</span><span class="fl">0.6</span>,</span>
<span id="cb2-46"><a href="#cb2-46" aria-hidden="true" tabindex="-1"></a>    selector<span class="op">=</span><span class="bu">dict</span>(<span class="bu">type</span><span class="op">=</span><span class="st">'choropleth'</span>)</span>
<span id="cb2-47"><a href="#cb2-47" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb2-48"><a href="#cb2-48" aria-hidden="true" tabindex="-1"></a>fig.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
                                <div class="cell-output cell-output-display">
                                    <div>                            <div id="6d2b7b49-535d-49e1-8b26-4d8330bd09c5" class="plotly-graph-div" style="height:500px; width:100%;"></div>           <script src="coup-readme_files/libs/quarto-html/plotly-2.js"></script>       </div>
                                </div>
                            </div>
                        </section>
                        <section id="scrollytelling-in-d3.js" class="level3">
                            <h3 class="anchored" data-anchor-id="scrollytelling-in-d3.js">2. Scrollytelling in D3.js</h3>
<div class="sourceCode" id="cb1"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co">// initialize d3 elements</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="bu">window</span><span class="op">.</span><span class="at">createGraphic</span> <span class="op">=</span> <span class="kw">function</span>(graphicSelector) {</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">var</span> graphicEl <span class="op">=</span> d3<span class="op">.</span><span class="fu">select</span>(<span class="st">&#39;.graphic&#39;</span>)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">var</span> graphicVisEl <span class="op">=</span> graphicEl<span class="op">.</span><span class="fu">select</span>(<span class="st">&#39;.graphic__vis&#39;</span>)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">var</span> graphicProseEl <span class="op">=</span> graphicEl<span class="op">.</span><span class="fu">select</span>(<span class="st">&#39;.graphic__prose&#39;</span>)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>    <span class="kw">var</span> graphicVisImg <span class="op">=</span> graphicVisEl<span class="op">.</span><span class="fu">select</span>(<span class="st">&#39;img&#39;</span>)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>    <span class="kw">var</span> graphicVisImgWrapper <span class="op">=</span> graphicVisEl<span class="op">.</span><span class="fu">select</span>(<span class="st">&#39;.img_wrapper&#39;</span>)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>    <span class="kw">var</span> paragraph <span class="op">=</span> <span class="bu">document</span><span class="op">.</span><span class="fu">getElementById</span>(<span class="st">&quot;img_text&quot;</span>)<span class="op">;</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>    <span class="co">// assign actions to each step</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>    <span class="kw">var</span> steps <span class="op">=</span> [</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>    <span class="kw">function</span> <span class="fu">step0</span>() {</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>        graphicVisImgWrapper<span class="op">.</span><span class="fu">style</span>(<span class="st">&#39;background&#39;</span><span class="op">,</span> <span class="st">&#39;url(../assets/img/portfolio/coup/1-kumba-yala.jpg)&#39;</span>)<span class="op">;</span></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>        paragraph<span class="op">.</span><span class="at">textContent</span> <span class="op">=</span> <span class="st">&quot;Kumba Yalá&quot;</span><span class="op">;</span></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>    }<span class="op">,</span></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>    <span class="kw">function</span> <span class="fu">step1</span>() {</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>        graphicVisImgWrapper<span class="op">.</span><span class="fu">style</span>(<span class="st">&#39;background&#39;</span><span class="op">,</span> <span class="st">&#39;url(../assets/img/portfolio/coup/2-henrique-rosa.jpg)&#39;</span>)<span class="op">;</span></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>        paragraph<span class="op">.</span><span class="at">textContent</span> <span class="op">=</span> <span class="st">&quot;Henrique Rosa&quot;</span><span class="op">;</span></span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a>    }<span class="op">,</span></span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a>    <span class="kw">function</span> <span class="fu">step2</span>() {</span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a>        graphicVisImgWrapper<span class="op">.</span><span class="fu">style</span>(<span class="st">&#39;background&#39;</span><span class="op">,</span> <span class="st">&#39;url(../assets/img/portfolio/coup/3-vieira.jpg)&#39;</span>)<span class="op">;</span></span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a>        paragraph<span class="op">.</span><span class="at">textContent</span> <span class="op">=</span> <span class="st">&quot;João Bernardo Vieira&quot;</span><span class="op">;</span></span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a>    }<span class="op">,</span></span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a>    <span class="kw">function</span> <span class="fu">step3</span>() {</span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a>        graphicVisImgWrapper<span class="op">.</span><span class="fu">style</span>(<span class="st">&#39;background&#39;</span><span class="op">,</span> <span class="st">&#39;url(../assets/img/portfolio/coup/4-sanha.jpg)&#39;</span>)<span class="op">;</span></span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a>        paragraph<span class="op">.</span><span class="at">textContent</span> <span class="op">=</span> <span class="st">&quot;Malam Bacai Sanhá&quot;</span><span class="op">;</span></span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a>    }<span class="op">,</span></span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a>    <span class="kw">function</span> <span class="fu">step4</span>() {</span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a>        graphicVisImgWrapper<span class="op">.</span><span class="fu">style</span>(<span class="st">&#39;background&#39;</span><span class="op">,</span> <span class="st">&#39;url(../assets/img/portfolio/coup/5-manuel.jpg)&#39;</span>)<span class="op">;</span></span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a>        paragraph<span class="op">.</span><span class="at">textContent</span> <span class="op">=</span> <span class="st">&quot;Manuel Serifo Nhamadjo&quot;</span><span class="op">;</span></span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a>    }<span class="op">,</span></span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a>    ]</span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true" tabindex="-1"></a>    <span class="co">// update chart</span></span>
<span id="cb1-35"><a href="#cb1-35" aria-hidden="true" tabindex="-1"></a>    <span class="kw">function</span> <span class="fu">update</span>(step) {</span>
<span id="cb1-36"><a href="#cb1-36" aria-hidden="true" tabindex="-1"></a>        steps[step]<span class="op">.</span><span class="fu">call</span>()</span>
<span id="cb1-37"><a href="#cb1-37" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb1-38"><a href="#cb1-38" aria-hidden="true" tabindex="-1"></a>    <span class="fu">update</span>(<span class="dv">0</span>)<span class="op">;</span></span>
<span id="cb1-39"><a href="#cb1-39" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> {</span>
<span id="cb1-40"><a href="#cb1-40" aria-hidden="true" tabindex="-1"></a>        <span class="dt">update</span><span class="op">:</span> update<span class="op">,</span></span>
<span id="cb1-41"><a href="#cb1-41" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb1-42"><a href="#cb1-42" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-43"><a href="#cb1-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-44"><a href="#cb1-44" aria-hidden="true" tabindex="-1"></a><span class="co">// handle the fixed/static position of the graphic</span></span>
<span id="cb1-45"><a href="#cb1-45" aria-hidden="true" tabindex="-1"></a><span class="fu">$</span>(<span class="bu">document</span>)<span class="op">.</span><span class="fu">ready</span>(<span class="kw">function</span>() {</span>
<span id="cb1-46"><a href="#cb1-46" aria-hidden="true" tabindex="-1"></a>    <span class="kw">function</span> <span class="fu">waypoints</span>() {</span>
<span id="cb1-47"><a href="#cb1-47" aria-hidden="true" tabindex="-1"></a>        <span class="kw">var</span> graphicEl <span class="op">=</span> <span class="bu">document</span><span class="op">.</span><span class="fu">querySelector</span>(<span class="st">&#39;.graphic&#39;</span>)<span class="op">;</span></span>
<span id="cb1-48"><a href="#cb1-48" aria-hidden="true" tabindex="-1"></a>        <span class="kw">var</span> graphicVisEl <span class="op">=</span> graphicEl<span class="op">.</span><span class="fu">querySelector</span>(<span class="st">&#39;.graphic__vis&#39;</span>)<span class="op">;</span></span>
<span id="cb1-49"><a href="#cb1-49" aria-hidden="true" tabindex="-1"></a>        <span class="kw">var</span> triggerEls <span class="op">=</span> <span class="fu">selectionToArray</span>(graphicEl<span class="op">.</span><span class="fu">querySelectorAll</span>(<span class="st">&#39;.trigger&#39;</span>))<span class="op">;</span></span>
<span id="cb1-50"><a href="#cb1-50" aria-hidden="true" tabindex="-1"></a>        <span class="kw">var</span> viewportHeight <span class="op">=</span> <span class="bu">window</span><span class="op">.</span><span class="at">innerHeight</span><span class="op">;</span></span>
<span id="cb1-51"><a href="#cb1-51" aria-hidden="true" tabindex="-1"></a>        <span class="kw">var</span> halfViewportHeight <span class="op">=</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">floor</span>(viewportHeight <span class="op">/</span> <span class="dv">2</span>)<span class="op">;</span></span>
<span id="cb1-52"><a href="#cb1-52" aria-hidden="true" tabindex="-1"></a>        <span class="co">// a global function creates and handles all the vis + updates</span></span>
<span id="cb1-53"><a href="#cb1-53" aria-hidden="true" tabindex="-1"></a>        <span class="kw">var</span> graphic <span class="op">=</span> <span class="fu">createGraphic</span>(<span class="st">&#39;.graphic&#39;</span>)<span class="op">;</span></span>
<span id="cb1-54"><a href="#cb1-54" aria-hidden="true" tabindex="-1"></a>        <span class="kw">var</span> toggle <span class="op">=</span> <span class="kw">function</span>(fixed<span class="op">,</span> bottom) {</span>
<span id="cb1-55"><a href="#cb1-55" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> (fixed) {</span>
<span id="cb1-56"><a href="#cb1-56" aria-hidden="true" tabindex="-1"></a>                graphicVisEl<span class="op">.</span><span class="at">classList</span><span class="op">.</span><span class="fu">add</span>(<span class="st">&#39;is-fixed&#39;</span>)<span class="op">;</span></span>
<span id="cb1-57"><a href="#cb1-57" aria-hidden="true" tabindex="-1"></a>            }</span>
<span id="cb1-58"><a href="#cb1-58" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span> {</span>
<span id="cb1-59"><a href="#cb1-59" aria-hidden="true" tabindex="-1"></a>                graphicVisEl<span class="op">.</span><span class="at">classList</span><span class="op">.</span><span class="fu">remove</span>(<span class="st">&#39;is-fixed&#39;</span>)<span class="op">;</span></span>
<span id="cb1-60"><a href="#cb1-60" aria-hidden="true" tabindex="-1"></a>            }</span>
<span id="cb1-61"><a href="#cb1-61" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> (bottom) {</span>
<span id="cb1-62"><a href="#cb1-62" aria-hidden="true" tabindex="-1"></a>                graphicVisEl<span class="op">.</span><span class="at">classList</span><span class="op">.</span><span class="fu">add</span>(<span class="st">&#39;is-bottom&#39;</span>)<span class="op">;</span></span>
<span id="cb1-63"><a href="#cb1-63" aria-hidden="true" tabindex="-1"></a>            }</span>
<span id="cb1-64"><a href="#cb1-64" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span> {</span>
<span id="cb1-65"><a href="#cb1-65" aria-hidden="true" tabindex="-1"></a>                graphicVisEl<span class="op">.</span><span class="at">classList</span><span class="op">.</span><span class="fu">remove</span>(<span class="st">&#39;is-bottom&#39;</span>)<span class="op">;</span></span>
<span id="cb1-66"><a href="#cb1-66" aria-hidden="true" tabindex="-1"></a>            }</span>
<span id="cb1-67"><a href="#cb1-67" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb1-68"><a href="#cb1-68" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1-69"><a href="#cb1-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-70"><a href="#cb1-70" aria-hidden="true" tabindex="-1"></a>        <span class="co">// set up a waypoint trigger for each trigger element</span></span>
<span id="cb1-71"><a href="#cb1-71" aria-hidden="true" tabindex="-1"></a>        <span class="kw">var</span> waypoints <span class="op">=</span> triggerEls<span class="op">.</span><span class="fu">map</span>(<span class="kw">function</span>(el) {</span>
<span id="cb1-72"><a href="#cb1-72" aria-hidden="true" tabindex="-1"></a>            <span class="co">// get the step, cast as number         </span></span>
<span id="cb1-73"><a href="#cb1-73" aria-hidden="true" tabindex="-1"></a>            <span class="kw">var</span> step <span class="op">=</span> <span class="op">+</span>el<span class="op">.</span><span class="fu">getAttribute</span>(<span class="st">&#39;data-step&#39;</span>)<span class="op">;</span></span>
<span id="cb1-74"><a href="#cb1-74" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="kw">new</span> <span class="fu">Waypoint</span>({</span>
<span id="cb1-75"><a href="#cb1-75" aria-hidden="true" tabindex="-1"></a>                <span class="dt">element</span><span class="op">:</span> el<span class="op">,</span> <span class="co">// our trigger element</span></span>
<span id="cb1-76"><a href="#cb1-76" aria-hidden="true" tabindex="-1"></a>                <span class="dt">handler</span><span class="op">:</span> <span class="kw">function</span>(direction) {</span>
<span id="cb1-77"><a href="#cb1-77" aria-hidden="true" tabindex="-1"></a>                    <span class="co">// if the direction is down then we use that number,</span></span>
<span id="cb1-78"><a href="#cb1-78" aria-hidden="true" tabindex="-1"></a>                    <span class="co">// else, we want to trigger the previous one</span></span>
<span id="cb1-79"><a href="#cb1-79" aria-hidden="true" tabindex="-1"></a>                    <span class="kw">var</span> nextStep <span class="op">=</span> direction <span class="op">===</span> <span class="st">&#39;down&#39;</span> <span class="op">?</span> step <span class="op">:</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">max</span>(<span class="dv">0</span><span class="op">,</span> step <span class="op">-</span> <span class="dv">1</span>)<span class="op">;</span></span>
<span id="cb1-80"><a href="#cb1-80" aria-hidden="true" tabindex="-1"></a>                    <span class="co">// tell our graphic to update with a specific step</span></span>
<span id="cb1-81"><a href="#cb1-81" aria-hidden="true" tabindex="-1"></a>                    graphic<span class="op">.</span><span class="fu">update</span>(nextStep)<span class="op">;</span></span>
<span id="cb1-82"><a href="#cb1-82" aria-hidden="true" tabindex="-1"></a>                }<span class="op">,</span></span>
<span id="cb1-83"><a href="#cb1-83" aria-hidden="true" tabindex="-1"></a>                <span class="dt">offset</span><span class="op">:</span> <span class="st">&#39;50%&#39;</span><span class="op">,</span>  <span class="co">// trigger halfway up the viewport</span></span>
<span id="cb1-84"><a href="#cb1-84" aria-hidden="true" tabindex="-1"></a>            })<span class="op">;</span></span>
<span id="cb1-85"><a href="#cb1-85" aria-hidden="true" tabindex="-1"></a>        })<span class="op">;</span></span>
<span id="cb1-86"><a href="#cb1-86" aria-hidden="true" tabindex="-1"></a>        <span class="co">// enter (top) / exit (bottom) graphic (toggle fixed position)</span></span>
<span id="cb1-87"><a href="#cb1-87" aria-hidden="true" tabindex="-1"></a>        <span class="kw">var</span> enterWaypoint <span class="op">=</span> <span class="kw">new</span> <span class="fu">Waypoint</span>({</span>
<span id="cb1-88"><a href="#cb1-88" aria-hidden="true" tabindex="-1"></a>            <span class="dt">element</span><span class="op">:</span> graphicEl<span class="op">,</span></span>
<span id="cb1-89"><a href="#cb1-89" aria-hidden="true" tabindex="-1"></a>            <span class="dt">handler</span><span class="op">:</span> <span class="kw">function</span>(direction) {</span>
<span id="cb1-90"><a href="#cb1-90" aria-hidden="true" tabindex="-1"></a>                <span class="kw">var</span> fixed <span class="op">=</span> direction <span class="op">===</span> <span class="st">&#39;down&#39;</span><span class="op">;</span></span>
<span id="cb1-91"><a href="#cb1-91" aria-hidden="true" tabindex="-1"></a>                <span class="kw">var</span> bottom <span class="op">=</span> <span class="kw">false</span><span class="op">;</span></span>
<span id="cb1-92"><a href="#cb1-92" aria-hidden="true" tabindex="-1"></a>                <span class="fu">toggle</span>(fixed<span class="op">,</span> bottom)<span class="op">;</span></span>
<span id="cb1-93"><a href="#cb1-93" aria-hidden="true" tabindex="-1"></a>            }<span class="op">,</span></span>
<span id="cb1-94"><a href="#cb1-94" aria-hidden="true" tabindex="-1"></a>        })<span class="op">;</span></span>
<span id="cb1-95"><a href="#cb1-95" aria-hidden="true" tabindex="-1"></a>        <span class="kw">var</span> exitWaypoint <span class="op">=</span> <span class="kw">new</span> <span class="fu">Waypoint</span>({</span>
<span id="cb1-96"><a href="#cb1-96" aria-hidden="true" tabindex="-1"></a>            <span class="dt">element</span><span class="op">:</span> graphicEl<span class="op">,</span></span>
<span id="cb1-97"><a href="#cb1-97" aria-hidden="true" tabindex="-1"></a>            <span class="dt">handler</span><span class="op">:</span> <span class="kw">function</span>(direction) {</span>
<span id="cb1-98"><a href="#cb1-98" aria-hidden="true" tabindex="-1"></a>                <span class="kw">var</span> fixed <span class="op">=</span> direction <span class="op">===</span> <span class="st">&#39;up&#39;</span><span class="op">;</span></span>
<span id="cb1-99"><a href="#cb1-99" aria-hidden="true" tabindex="-1"></a>                <span class="kw">var</span> bottom <span class="op">=</span> <span class="op">!</span>fixed<span class="op">;</span></span>
<span id="cb1-100"><a href="#cb1-100" aria-hidden="true" tabindex="-1"></a>                <span class="fu">toggle</span>(fixed<span class="op">,</span> bottom)<span class="op">;</span></span>
<span id="cb1-101"><a href="#cb1-101" aria-hidden="true" tabindex="-1"></a>            }<span class="op">,</span></span>
<span id="cb1-102"><a href="#cb1-102" aria-hidden="true" tabindex="-1"></a>            <span class="dt">offset</span><span class="op">:</span> <span class="st">&#39;bottom-in-view&#39;</span><span class="op">,</span></span>
<span id="cb1-103"><a href="#cb1-103" aria-hidden="true" tabindex="-1"></a>        })<span class="op">;</span></span>
<span id="cb1-104"><a href="#cb1-104" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb1-105"><a href="#cb1-105" aria-hidden="true" tabindex="-1"></a>    <span class="fu">waypoints</span>()<span class="op">;</span></span>
<span id="cb1-106"><a href="#cb1-106" aria-hidden="true" tabindex="-1"></a>})<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<!-- <pre><code class="lang-js"><span class="hljs-comment">// initialize d3 elements</span>
window.createGraphic = function(graphicSelector) {
    <span class="hljs-keyword">var</span> graphicEl = d3.<span class="hljs-keyword">select</span>(<span class="hljs-string">'.graphic'</span>)
    <span class="hljs-keyword">var</span> graphicVisEl = graphicEl.<span class="hljs-keyword">select</span>(<span class="hljs-string">'.graphic__vis'</span>)
    <span class="hljs-keyword">var</span> graphicProseEl = graphicEl.<span class="hljs-keyword">select</span>(<span class="hljs-string">'.graphic__prose'</span>)
    <span class="hljs-keyword">var</span> graphicVisImg = graphicVisEl.<span class="hljs-keyword">select</span>(<span class="hljs-string">'img'</span>)
    <span class="hljs-keyword">var</span> graphicVisImgWrapper = graphicVisEl.<span class="hljs-keyword">select</span>(<span class="hljs-string">'.img_wrapper'</span>)
    <span class="hljs-keyword">var</span> paragraph = document.getElementById(<span class="hljs-string">"img_text"</span>);
        </code></pre>
<pre><code class="lang-js">  
    <span class="hljs-comment">// assign actions to each step</span>
    <span class="hljs-keyword">var</span> steps = [
    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">step0</span><span class="hljs-params">()</span> </span>{
        graphicVisImgWrapper.style(<span class="hljs-string">'background'</span>, <span class="hljs-string">'url(../assets/img/portfolio/coup/1-kumba-yala.jpg)'</span>);
        paragraph.textContent = <span class="hljs-string">"Kumba Yalá"</span>;
    },
    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">step1</span><span class="hljs-params">()</span> </span>{
        graphicVisImgWrapper.style(<span class="hljs-string">'background'</span>, <span class="hljs-string">'url(../assets/img/portfolio/coup/2-henrique-rosa.jpg)'</span>);
        paragraph.textContent = <span class="hljs-string">"Henrique Rosa"</span>;
    },
    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">step2</span><span class="hljs-params">()</span> </span>{
        graphicVisImgWrapper.style(<span class="hljs-string">'background'</span>, <span class="hljs-string">'url(../assets/img/portfolio/coup/3-vieira.jpg)'</span>);
        paragraph.textContent = <span class="hljs-string">"João Bernardo Vieira"</span>;
    },
    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">step3</span><span class="hljs-params">()</span> </span>{
        graphicVisImgWrapper.style(<span class="hljs-string">'background'</span>, <span class="hljs-string">'url(../assets/img/portfolio/coup/4-sanha.jpg)'</span>);
        paragraph.textContent = <span class="hljs-string">"Malam Bacai Sanhá"</span>;
    },
    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">step4</span><span class="hljs-params">()</span> </span>{
        graphicVisImgWrapper.style(<span class="hljs-string">'background'</span>, <span class="hljs-string">'url(../assets/img/portfolio/coup/5-manuel.jpg)'</span>);
        paragraph.textContent = <span class="hljs-string">"Manuel Serifo Nhamadjo"</span>;
    },
    ]
    <span class="hljs-comment">// update chart</span>
    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">update</span><span class="hljs-params">(step)</span> </span>{
        steps[step].call()
    }
    update(<span class="hljs-number">0</span>);
    <span class="hljs-keyword">return</span> {
        update: update,
    }
}
</code></pre>
                            <hr>
                            <pre><code class="lang-js">
<span class="hljs-comment">// handle the fixed/static position of the graphic</span>
$(<span class="hljs-built_in">document</span>).ready(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">waypoints</span>(<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">var</span> graphicEl = <span class="hljs-built_in">document</span>.querySelector(<span class="hljs-string">'.graphic'</span>);
        <span class="hljs-keyword">var</span> graphicVisEl = graphicEl.querySelector(<span class="hljs-string">'.graphic__vis'</span>);
        <span class="hljs-keyword">var</span> triggerEls = selectionToArray(graphicEl.querySelectorAll(<span class="hljs-string">'.trigger'</span>));
        <span class="hljs-keyword">var</span> viewportHeight = <span class="hljs-built_in">window</span>.innerHeight;
        <span class="hljs-keyword">var</span> halfViewportHeight = <span class="hljs-built_in">Math</span>.floor(viewportHeight / <span class="hljs-number">2</span>);
        <span class="hljs-comment">// a global function creates and handles all the vis + updates</span>
        <span class="hljs-keyword">var</span> graphic = createGraphic(<span class="hljs-string">'.graphic'</span>);
        <span class="hljs-keyword">var</span> toggle = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">fixed, bottom</span>) </span>{
            <span class="hljs-keyword">if</span> (fixed) {
                graphicVisEl.classList.add(<span class="hljs-string">'is-fixed'</span>);
            }
            <span class="hljs-keyword">else</span> {
                graphicVisEl.classList.remove(<span class="hljs-string">'is-fixed'</span>);
            }
            <span class="hljs-keyword">if</span> (bottom) {
                graphicVisEl.classList.add(<span class="hljs-string">'is-bottom'</span>);
            }
            <span class="hljs-keyword">else</span> {
                graphicVisEl.classList.remove(<span class="hljs-string">'is-bottom'</span>);
            }
        }
    </code></pre>
                                    <pre><code class="lang-js">
        <span class="hljs-comment">// set up a waypoint trigger for each trigger element</span>
        <span class="hljs-keyword">var</span> waypoints = triggerEls.map(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">el</span>) </span>{
            <span class="hljs-comment">// get the step, cast as number         </span>
            <span class="hljs-keyword">var</span> step = +el.getAttribute(<span class="hljs-string">'data-step'</span>);
            <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> Waypoint({
                <span class="hljs-attr">element</span>: el, <span class="hljs-comment">// our trigger element</span>
                handler: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">direction</span>) </span>{
                    <span class="hljs-comment">// if the direction is down then we use that number,</span>
                    <span class="hljs-comment">// else, we want to trigger the previous one</span>
                    <span class="hljs-keyword">var</span> nextStep = direction === <span class="hljs-string">'down'</span> ? step : <span class="hljs-built_in">Math</span>.max(<span class="hljs-number">0</span>, step - <span class="hljs-number">1</span>);
                    <span class="hljs-comment">// tell our graphic to update with a specific step</span>
                    graphic.update(nextStep);
                },
                <span class="hljs-attr">offset</span>: <span class="hljs-string">'50%'</span>,  <span class="hljs-comment">// trigger halfway up the viewport</span>
            });
        });
        <span class="hljs-comment">// enter (top) / exit (bottom) graphic (toggle fixed position)</span>
        <span class="hljs-keyword">var</span> enterWaypoint = <span class="hljs-keyword">new</span> Waypoint({
            <span class="hljs-attr">element</span>: graphicEl,
            <span class="hljs-attr">handler</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">direction</span>) </span>{
                <span class="hljs-keyword">var</span> fixed = direction === <span class="hljs-string">'down'</span>;
                <span class="hljs-keyword">var</span> bottom = <span class="hljs-literal">false</span>;
                toggle(fixed, bottom);
            },
        });
        <span class="hljs-keyword">var</span> exitWaypoint = <span class="hljs-keyword">new</span> Waypoint({
            <span class="hljs-attr">element</span>: graphicEl,
            <span class="hljs-attr">handler</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">direction</span>) </span>{
                <span class="hljs-keyword">var</span> fixed = direction === <span class="hljs-string">'up'</span>;
                <span class="hljs-keyword">var</span> bottom = !fixed;
                toggle(fixed, bottom);
            },
            <span class="hljs-attr">offset</span>: <span class="hljs-string">'bottom-in-view'</span>,
        });
    }
    waypoints();
});
</code></pre> -->
                            
                        </section>
                        <section id="plotting-year-on-year-percentage-change-in-gdp-as-a-bar-chart" class="level3">
                            <h3 class="anchored" data-anchor-id="plotting-year-on-year-percentage-change-in-gdp-as-a-bar-chart">3. Plotting year-on-year percentage change in GDP as a bar chart</h3>
                            <div id="681368b2" class="cell" data-execution_count="3">
                                <div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python">
<span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> plotly.express <span class="im">as</span> px</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>gdp <span class="op">=</span> pd.read_csv(<span class="st">'gdp.csv'</span>)</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>gdp[<span class="st">'GDPchange'</span>] <span class="op">=</span> gdp.<span class="bu">apply</span>(<span class="kw">lambda</span> x: x[<span class="st">'GDPchange'</span>][:<span class="op">-</span><span class="dv">1</span>] , axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>gdp[<span class="st">'GDPchange'</span>] <span class="op">=</span> gdp[<span class="st">'GDPchange'</span>].<span class="bu">str</span>[:<span class="op">-</span><span class="dv">1</span>].astype(<span class="bu">float</span>)</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>gdp.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
                                    <div class="cell-output cell-output-display" data-execution_count="3">
                                        <div>
                                            <div>
                                                
                                                
                                                <table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
                                                    <thead>
                                                        <tr class="header">
                                                            <th data-quarto-table-cell-role="th"></th>
                                                            <th data-quarto-table-cell-role="th">Year</th>
                                                            <th data-quarto-table-cell-role="th">GDPchange</th>
                                                        </tr>
                                                    </thead>
                                                    <tbody>
                                                        <tr class="odd">
                                                            <td data-quarto-table-cell-role="th">0</td>
                                                            <td>1994</td>
                                                            <td>3.2</td>
                                                        </tr>
                                                        <tr class="even">
                                                            <td data-quarto-table-cell-role="th">1</td>
                                                            <td>1995</td>
                                                            <td>4.4</td>
                                                        </tr>
                                                        <tr class="odd">
                                                            <td data-quarto-table-cell-role="th">2</td>
                                                            <td>1996</td>
                                                            <td>11.6</td>
                                                        </tr>
                                                        <tr class="even">
                                                            <td data-quarto-table-cell-role="th">3</td>
                                                            <td>1997</td>
                                                            <td>6.5</td>
                                                        </tr>
                                                        <tr class="odd">
                                                            <td data-quarto-table-cell-role="th">4</td>
                                                            <td>1998</td>
                                                            <td>-28.1</td>
                                                        </tr>
                                                    </tbody>
                                                </table>
                                                
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div id="20fca701" class="cell" data-execution_count="4">
                                    <div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>gdp[<span class="st">'GDPchange'</span>].dtype</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
                                    <div class="cell-output cell-output-display" data-execution_count="4">
                                        <pre><code>dtype('float64')</code></pre>
                                    </div>
                                </div>
                                <div id="2f02830e" class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> plotly.graph_objects <span class="im">as</span> go</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> px.bar(gdp, x<span class="op">=</span><span class="st">'Year'</span>, y<span class="op">=</span><span class="st">'GDPchange'</span>,</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>         template<span class="op">=</span><span class="st">"plotly_dark"</span>)</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>config <span class="op">=</span> {</span>
    <span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">'displayModeBar'</span>: <span class="va">False</span>,</span>
    <span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">'showAxisDragHandles'</span>: <span class="va">True</span>,</span>
    <span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>    <span class="st">'showAxisRangeEntryBoxes'</span> : <span class="va">False</span>,</span>
    <span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>    <span class="st">'editable'</span>: <span class="va">False</span>,</span>
    <span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>    <span class="st">'doubleClick'</span>: <span class="va">False</span></span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>         }</span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>fig.update_xaxes(fixedrange<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a>fig.update_yaxes(fixedrange<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a>fig.update_traces(marker_line_color<span class="op">=</span><span class="st">'rgb(8,48,107)'</span>,</span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a>                  marker_line_width<span class="op">=</span><span class="dv">1</span>, opacity<span class="op">=</span><span class="fl">0.6</span>)</span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a>fig.show(config<span class="op">=</span>config)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
    <div class="cell-output cell-output-display">
        <div>                            <div id="1cec0e9f-c697-45dc-bbfb-1a4afc6b6279" class="plotly-graph-div" style="height:525px; width:100%;"></div>            <script src="coup-readme_files/libs/quarto-html/plotly-3.js"></script>      </div>
                                            </div>
                                        </div>
                                        <br>
                                        <p>I made the final bar chart from a CSV in JavaScript using the Chart.js library for better responsiveness and interactivity.  </p>

<div class="sourceCode" id="cb2"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">$</span>(<span class="bu">document</span>)<span class="op">.</span><span class="fu">ready</span>(<span class="kw">function</span>() {</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;use strict&quot;</span><span class="op">;</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>    $<span class="op">.</span><span class="fu">ajax</span>({</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>    <span class="dt">type</span><span class="op">:</span> <span class="st">&quot;GET&quot;</span><span class="op">,</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>    <span class="dt">url</span><span class="op">:</span> <span class="st">&quot;../chart-data/sanitised-gdp.csv&quot;</span><span class="op">,</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>    <span class="dt">dataType</span><span class="op">:</span> <span class="st">&quot;text&quot;</span><span class="op">,</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>    <span class="dt">success</span><span class="op">:</span> <span class="kw">function</span>(data) {<span class="fu">processGDP</span>(data)<span class="op">;</span>}</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>    })<span class="op">;</span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>})<span class="op">;</span></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">processGDP</span>(csvdata) {</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;use strict&quot;</span><span class="op">;</span></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>    <span class="kw">var</span> data_array <span class="op">=</span> $<span class="op">.</span><span class="at">csv</span><span class="op">.</span><span class="fu">toArrays</span>(csvdata)<span class="op">;</span></span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>    data_array<span class="op">.</span><span class="fu">splice</span>(<span class="dv">0</span><span class="op">,</span> <span class="dv">1</span>)<span class="op">;</span></span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>    <span class="bu">console</span><span class="op">.</span><span class="fu">log</span>(data_array)<span class="op">;</span></span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> arrayColumn <span class="op">=</span> (arr<span class="op">,</span> n) <span class="kw">=&gt;</span> arr<span class="op">.</span><span class="fu">map</span>(x <span class="kw">=&gt;</span> x[n])<span class="op">;</span></span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> years <span class="op">=</span> <span class="fu">arrayColumn</span>(data_array<span class="op">,</span> <span class="dv">1</span>)<span class="op">;</span></span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> gdps <span class="op">=</span> <span class="fu">arrayColumn</span>(data_array<span class="op">,</span> <span class="dv">2</span>)<span class="op">;</span></span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a>    years[<span class="dv">3</span>] <span class="op">=</span> [years[<span class="dv">3</span>]<span class="op">,</span> <span class="st">&quot; test&quot;</span>]<span class="op">;</span></span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a>    <span class="bu">console</span><span class="op">.</span><span class="fu">log</span>(years)<span class="op">;</span></span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> data <span class="op">=</span> {</span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a>        <span class="dt">labels</span><span class="op">:</span> [<span class="st">&#39;2001&#39;</span><span class="op">,</span><span class="st">&#39;2002&#39;</span><span class="op">,</span>[<span class="st">&#39;2003&#39;</span><span class="op">,</span><span class="st">&#39;First Coup&#39;</span>]<span class="op">,</span><span class="st">&#39;2004&#39;</span><span class="op">,</span><span class="st">&#39;2005&#39;</span><span class="op">,</span><span class="st">&#39;2006&#39;</span><span class="op">,</span><span class="st">&#39;2007&#39;</span><span class="op">,</span><span class="st">&#39;2008&#39;</span><span class="op">,</span><span class="st">&#39;2009&#39;</span><span class="op">,</span> <span class="st">&#39;2010&#39;</span><span class="op">,</span><span class="st">&#39;2011&#39;</span><span class="op">,</span>[<span class="st">&#39;2012&#39;</span><span class="op">,</span><span class="st">&#39;Second Coup&#39;</span>]<span class="op">,</span><span class="st">&#39;2013&#39;</span>]<span class="op">,</span></span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a>        <span class="dt">datasets</span><span class="op">:</span> [{</span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a>            <span class="dt">label</span><span class="op">:</span> <span class="st">&#39;GDP % Change&#39;</span><span class="op">,</span></span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a>            <span class="dt">data</span><span class="op">:</span> gdps<span class="op">,</span></span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a>            <span class="dt">backgroundColor</span><span class="op">:</span> <span class="st">&#39;rgba(54, 162, 235, 0.2)&#39;</span><span class="op">,</span></span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true" tabindex="-1"></a>            <span class="dt">borderColor</span><span class="op">:</span> <span class="st">&#39;rgb(54, 162, 235)&#39;</span><span class="op">,</span></span>
<span id="cb2-27"><a href="#cb2-27" aria-hidden="true" tabindex="-1"></a>            <span class="dt">borderWidth</span><span class="op">:</span> <span class="dv">1</span><span class="op">,</span></span>
<span id="cb2-28"><a href="#cb2-28" aria-hidden="true" tabindex="-1"></a>        }]<span class="op">,</span></span>
<span id="cb2-29"><a href="#cb2-29" aria-hidden="true" tabindex="-1"></a>    }<span class="op">;</span></span>
<span id="cb2-30"><a href="#cb2-30" aria-hidden="true" tabindex="-1"></a>    <span class="kw">var</span> ctx <span class="op">=</span> <span class="bu">document</span><span class="op">.</span><span class="fu">getElementById</span>(<span class="st">&#39;gdp-barchart&#39;</span>)<span class="op">.</span><span class="fu">getContext</span>(<span class="st">&#39;2d&#39;</span>)<span class="op">;</span></span>
<span id="cb2-31"><a href="#cb2-31" aria-hidden="true" tabindex="-1"></a>    <span class="kw">var</span> myChart <span class="op">=</span> <span class="kw">new</span> <span class="fu">Chart</span>(ctx<span class="op">,</span> {</span>
<span id="cb2-32"><a href="#cb2-32" aria-hidden="true" tabindex="-1"></a>        <span class="dt">type</span><span class="op">:</span> <span class="st">&#39;bar&#39;</span><span class="op">,</span></span>
<span id="cb2-33"><a href="#cb2-33" aria-hidden="true" tabindex="-1"></a>        <span class="dt">data</span><span class="op">:</span> data<span class="op">,</span></span>
<span id="cb2-34"><a href="#cb2-34" aria-hidden="true" tabindex="-1"></a>        <span class="dt">options</span><span class="op">:</span> {</span>
<span id="cb2-35"><a href="#cb2-35" aria-hidden="true" tabindex="-1"></a>            <span class="dt">responsive</span><span class="op">:</span> <span class="kw">true</span><span class="op">,</span></span>
<span id="cb2-36"><a href="#cb2-36" aria-hidden="true" tabindex="-1"></a>            <span class="dt">scales</span><span class="op">:</span> {</span>
<span id="cb2-37"><a href="#cb2-37" aria-hidden="true" tabindex="-1"></a>                <span class="dt">x</span><span class="op">:</span> {</span>
<span id="cb2-38"><a href="#cb2-38" aria-hidden="true" tabindex="-1"></a>                    <span class="dt">ticks</span><span class="op">:</span> {</span>
<span id="cb2-39"><a href="#cb2-39" aria-hidden="true" tabindex="-1"></a>                        <span class="dt">color</span><span class="op">:</span> <span class="st">&#39;#fff&#39;</span><span class="op">,</span></span>
<span id="cb2-40"><a href="#cb2-40" aria-hidden="true" tabindex="-1"></a>                    }</span>
<span id="cb2-41"><a href="#cb2-41" aria-hidden="true" tabindex="-1"></a>                }<span class="op">,</span></span>
<span id="cb2-42"><a href="#cb2-42" aria-hidden="true" tabindex="-1"></a>                <span class="dt">y</span><span class="op">:</span> {</span>
<span id="cb2-43"><a href="#cb2-43" aria-hidden="true" tabindex="-1"></a>                    <span class="dt">beginAtZero</span><span class="op">:</span> <span class="kw">true</span><span class="op">,</span></span>
<span id="cb2-44"><a href="#cb2-44" aria-hidden="true" tabindex="-1"></a>                    <span class="dt">ticks</span><span class="op">:</span> {</span>
<span id="cb2-45"><a href="#cb2-45" aria-hidden="true" tabindex="-1"></a>                        <span class="dt">color</span><span class="op">:</span> <span class="st">&#39;#fff&#39;</span></span>
<span id="cb2-46"><a href="#cb2-46" aria-hidden="true" tabindex="-1"></a>                    }<span class="op">,</span></span>
<span id="cb2-47"><a href="#cb2-47" aria-hidden="true" tabindex="-1"></a>                }</span>
<span id="cb2-48"><a href="#cb2-48" aria-hidden="true" tabindex="-1"></a>            }<span class="op">,</span></span>
<span id="cb2-49"><a href="#cb2-49" aria-hidden="true" tabindex="-1"></a>            <span class="dt">plugins</span><span class="op">:</span> {</span>
<span id="cb2-50"><a href="#cb2-50" aria-hidden="true" tabindex="-1"></a>                <span class="dt">legend</span><span class="op">:</span> { </span>
<span id="cb2-51"><a href="#cb2-51" aria-hidden="true" tabindex="-1"></a>                    <span class="dt">display</span><span class="op">:</span> <span class="kw">false</span><span class="op">,</span></span>
<span id="cb2-52"><a href="#cb2-52" aria-hidden="true" tabindex="-1"></a>                }<span class="op">,</span></span>
<span id="cb2-53"><a href="#cb2-53" aria-hidden="true" tabindex="-1"></a>                <span class="dt">tooltip</span><span class="op">:</span> {</span>
<span id="cb2-54"><a href="#cb2-54" aria-hidden="true" tabindex="-1"></a>                    <span class="dt">usePointStyle</span><span class="op">:</span> <span class="kw">true</span><span class="op">,</span></span>
<span id="cb2-55"><a href="#cb2-55" aria-hidden="true" tabindex="-1"></a>                    <span class="dt">backgroundColor</span><span class="op">:</span> <span class="st">&#39;gray&#39;</span></span>
<span id="cb2-56"><a href="#cb2-56" aria-hidden="true" tabindex="-1"></a>                }</span>
<span id="cb2-57"><a href="#cb2-57" aria-hidden="true" tabindex="-1"></a>            }<span class="op">,</span></span>
<span id="cb2-58"><a href="#cb2-58" aria-hidden="true" tabindex="-1"></a>        }<span class="op">,</span></span>
<span id="cb2-59"><a href="#cb2-59" aria-hidden="true" tabindex="-1"></a>    })<span class="op">;</span></span>
<span id="cb2-60"><a href="#cb2-60" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
                                        <!-- <pre><code class="lang-js">
$(<span class="hljs-built_in">document</span>).ready(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
<span class="hljs-meta">  "use strict"</span>;
$.ajax({
<span class="hljs-attr">type</span>: <span class="hljs-string">"GET"</span>,
<span class="hljs-attr">url</span>: <span class="hljs-string">"../chart-data/sanitised-gdp.csv"</span>,
<span class="hljs-attr">dataType</span>: <span class="hljs-string">"text"</span>,
<span class="hljs-attr">success</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">data</span>) </span>{processGDP(data);}
        });
    });
    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">processGDP</span>(<span class="hljs-params">csvdata</span>) </span>{
        <span class="hljs-meta">  "use strict"</span>;
        <span class="hljs-keyword">var</span> data_array = $.csv.toArrays(csvdata);
        data_array.splice(<span class="hljs-number">0</span>, <span class="hljs-number">1</span>);
        <span class="hljs-built_in">console</span>.log(data_array);
        <span class="hljs-keyword">const</span> arrayColumn = <span class="hljs-function">(<span class="hljs-params">arr, n</span>) =&gt;</span> arr.map(<span class="hljs-function"><span class="hljs-params">x</span> =&gt;</span> x[n]);
        <span class="hljs-keyword">const</span> years = arrayColumn(data_array, <span class="hljs-number">1</span>);
        <span class="hljs-keyword">const</span> gdps = arrayColumn(data_array, <span class="hljs-number">2</span>);
        years[<span class="hljs-number">3</span>] = [years[<span class="hljs-number">3</span>], <span class="hljs-string">" test"</span>];
        <span class="hljs-built_in">console</span>.log(years);
        <span class="hljs-keyword">const</span> data = {
            <span class="hljs-attr">labels</span>: [<span class="hljs-string">'2001'</span>,<span class="hljs-string">'2002'</span>,[<span class="hljs-string">'2003'</span>,<span class="hljs-string">'First Coup'</span>],<span class="hljs-string">'2004'</span>,<span class="hljs-string">'2005'</span>,<span class="hljs-string">'2006'</span>,<span class="hljs-string">'2007'</span>,<span class="hljs-string">'2008'</span>,<span class="hljs-string">'2009'</span>, <span class="hljs-string">'2010'</span>,<span class="hljs-string">'2011'</span>,[<span class="hljs-string">'2012'</span>,<span class="hljs-string">'Second Coup'</span>],<span class="hljs-string">'2013'</span>],
            <span class="hljs-attr">datasets</span>: [{
                <span class="hljs-attr">label</span>: <span class="hljs-string">'GDP % Change'</span>,
                <span class="hljs-attr">data</span>: gdps,
                <span class="hljs-attr">backgroundColor</span>: <span class="hljs-string">'rgba(54, 162, 235, 0.2)'</span>,
                <span class="hljs-attr">borderColor</span>: <span class="hljs-string">'rgb(54, 162, 235)'</span>,
                <span class="hljs-attr">borderWidth</span>: <span class="hljs-number">1</span>,
            }],
        };
        <span class="hljs-keyword">var</span> ctx = <span class="hljs-built_in">document</span>.getElementById(<span class="hljs-string">'gdp-barchart'</span>).getContext(<span class="hljs-string">'2d'</span>);
        <span class="hljs-keyword">var</span> myChart = <span class="hljs-keyword">new</span> Chart(ctx, {
            <span class="hljs-attr">type</span>: <span class="hljs-string">'bar'</span>,
            <span class="hljs-attr">data</span>: data,
            <span class="hljs-attr">options</span>: {
                <span class="hljs-attr">responsive</span>: <span class="hljs-literal">true</span>,
                <span class="hljs-attr">scales</span>: {
                    <span class="hljs-attr">x</span>: {
                        <span class="hljs-attr">ticks</span>: {
                            <span class="hljs-attr">color</span>: <span class="hljs-string">'#fff'</span>,
                        }
                    },
                    <span class="hljs-attr">y</span>: {
                        <span class="hljs-attr">beginAtZero</span>: <span class="hljs-literal">true</span>,
                        <span class="hljs-attr">ticks</span>: {
                            <span class="hljs-attr">color</span>: <span class="hljs-string">'#fff'</span>
                        },
                    }
                },
                <span class="hljs-attr">plugins</span>: {
                    <span class="hljs-attr">legend</span>: { 
                        <span class="hljs-attr">display</span>: <span class="hljs-literal">false</span>,
                    },
                    <span class="hljs-attr">tooltip</span>: {
                        <span class="hljs-attr">usePointStyle</span>: <span class="hljs-literal">true</span>,
                        <span class="hljs-attr">backgroundColor</span>: <span class="hljs-string">'gray'</span>
                    }
                },
            },
        });
    }
</code></pre> -->
                                    
                                </section>
                                <section id="future-work" class="level3">
                                    <h3 class="anchored" data-anchor-id="future-work">Future work</h3>
                                    <p>In December 2023, Embaló dissolved parliament citing allegations of an attempted coup d’état. I’m interested in continuing this story during the next presidential elections scheduled for November 2025.</p>
                                </section>
                            </section>
                        </main>
                        <!-- /main column -->
                        <script id="quarto-html-after-body" type="application/javascript">
                            window.document.addEventListener("DOMContentLoaded", function (event) {
                                const toggleBodyColorMode = (bsSheetEl) => {
                                    const mode = bsSheetEl.getAttribute("data-mode");
                                    const bodyEl = window.document.querySelector("body");
                                    if (mode === "dark") {
                                        bodyEl.classList.add("quarto-dark");
                                        bodyEl.classList.remove("quarto-light");
                                    } else {
                                        bodyEl.classList.add("quarto-light");
                                        bodyEl.classList.remove("quarto-dark");
                                    }
                                }
                                const toggleBodyColorPrimary = () => {
                                    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
                                    if (bsSheetEl) {
                                        toggleBodyColorMode(bsSheetEl);
                                    }
                                }
                                toggleBodyColorPrimary();  
                                const icon = "";
                                const anchorJS = new window.AnchorJS();
                                anchorJS.options = {
                                    placement: 'right',
                                    icon: icon
                                };
                                anchorJS.add('.anchored');
                                const isCodeAnnotation = (el) => {
                                    for (const clz of el.classList) {
                                        if (clz.startsWith('code-annotation-')) {                     
                                            return true;
                                        }
                                    }
                                    return false;
                                }
                                const clipboard = new window.ClipboardJS('.code-copy-button', {
                                    text: function(trigger) {
                                        const codeEl = trigger.previousElementSibling.cloneNode(true);
                                        for (const childEl of codeEl.children) {
                                            if (isCodeAnnotation(childEl)) {
                                                childEl.remove();
                                            }
                                        }
                                        return codeEl.innerText;
                                    }
                                });
                                clipboard.on('success', function(e) {
                                    // button target
                                    const button = e.trigger;
                                    // don't keep focus
                                    button.blur();
                                    // flash "checked"
                                    button.classList.add('code-copy-button-checked');
                                    var currentTitle = button.getAttribute("title");
                                    button.setAttribute("title", "Copied!");
                                    let tooltip;
                                    if (window.bootstrap) {
                                        button.setAttribute("data-bs-toggle", "tooltip");
                                        button.setAttribute("data-bs-placement", "left");
                                        button.setAttribute("data-bs-title", "Copied!");
                                        tooltip = new bootstrap.Tooltip(button, 
                                        { trigger: "manual", 
                                        customClass: "code-copy-button-tooltip",
                                        offset: [0, -8]});
                                        tooltip.show();    
                                    }
                                    setTimeout(function() {
                                        if (tooltip) {
                                            tooltip.hide();
                                            button.removeAttribute("data-bs-title");
                                            button.removeAttribute("data-bs-toggle");
                                            button.removeAttribute("data-bs-placement");
                                        }
                                        button.setAttribute("title", currentTitle);
                                        button.classList.remove('code-copy-button-checked');
                                    }, 1000);
                                    // clear code selection
                                    e.clearSelection();
                                });
                                function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
                                    const config = {
                                        allowHTML: true,
                                        maxWidth: 500,
                                        delay: 100,
                                        arrow: false,
                                        appendTo: function(el) {
                                            return el.parentElement;
                                        },
                                        interactive: true,
                                        interactiveBorder: 10,
                                        theme: 'quarto',
                                        placement: 'bottom-start',
                                    };
                                    if (contentFn) {
                                        config.content = contentFn;
                                    }
                                    if (onTriggerFn) {
                                        config.onTrigger = onTriggerFn;
                                    }
                                    if (onUntriggerFn) {
                                        config.onUntrigger = onUntriggerFn;
                                    }
                                    window.tippy(el, config); 
                                }
                                const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
                                for (var i=0; i<noterefs.length; i++) {
                                    const ref = noterefs[i];
                                    tippyHover(ref, function() {
                                        // use id or data attribute instead here
                                        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
                                        try { href = new URL(href).hash; } catch {}
                                        const id = href.replace(/^#\/?/, "");
                                        const note = window.document.getElementById(id);
                                        return note.innerHTML;
                                    });
                                }
                                const xrefs = window.document.querySelectorAll('a.quarto-xref');
                                const processXRef = (id, note) => {
                                    // Strip column container classes
                                    const stripColumnClz = (el) => {
                                        el.classList.remove("page-full", "page-columns");
                                        if (el.children) {
                                            for (const child of el.children) {
                                                stripColumnClz(child);
                                            }
                                        }
                                    }
                                    stripColumnClz(note)
                                    if (id === null || id.startsWith('sec-')) {
                                        // Special case sections, only their first couple elements
                                        const container = document.createElement("div");
                                        if (note.children && note.children.length > 2) {
                                            container.appendChild(note.children[0].cloneNode(true));
                                            for (let i = 1; i < note.children.length; i++) {
                                                const child = note.children[i];
                                                if (child.tagName === "P" && child.innerText === "") {
                                                    continue;
                                                } else {
                                                    container.appendChild(child.cloneNode(true));
                                                    break;
                                                }
                                            }
                                            if (window.Quarto?.typesetMath) {
                                                window.Quarto.typesetMath(container);
                                            }
                                            return container.innerHTML
                                        } else {
                                            if (window.Quarto?.typesetMath) {
                                                window.Quarto.typesetMath(note);
                                            }
                                            return note.innerHTML;
                                        }
                                    } else {
                                        // Remove any anchor links if they are present
                                        const anchorLink = note.querySelector('a.anchorjs-link');
                                        if (anchorLink) {
                                            anchorLink.remove();
                                        }
                                        if (window.Quarto?.typesetMath) {
                                            window.Quarto.typesetMath(note);
                                        }
                                        // TODO in 1.5, we should make sure this works without a callout special case
                                        if (note.classList.contains("callout")) {
                                            return note.outerHTML;
                                        } else {
                                            return note.innerHTML;
                                        }
                                    }
                                }
                                for (var i=0; i<xrefs.length; i++) {
                                    const xref = xrefs[i];
                                    tippyHover(xref, undefined, function(instance) {
                                        instance.disable();
                                        let url = xref.getAttribute('href');
                                        let hash = undefined; 
                                        if (url.startsWith('#')) {
                                            hash = url;
                                        } else {
                                            try { hash = new URL(url).hash; } catch {}
                                        }
                                        if (hash) {
                                            const id = hash.replace(/^#\/?/, "");
                                            const note = window.document.getElementById(id);
                                            if (note !== null) {
                                                try {
                                                    const html = processXRef(id, note.cloneNode(true));
                                                    instance.setContent(html);
                                                } finally {
                                                    instance.enable();
                                                    instance.show();
                                                }
                                            } else {
                                                // See if we can fetch this
                                                fetch(url.split('#')[0])
                                                .then(res => res.text())
                                                .then(html => {
                                                    const parser = new DOMParser();
                                                    const htmlDoc = parser.parseFromString(html, "text/html");
                                                    const note = htmlDoc.getElementById(id);
                                                    if (note !== null) {
                                                        const html = processXRef(id, note);
                                                        instance.setContent(html);
                                                    } 
                                                }).finally(() => {
                                                    instance.enable();
                                                    instance.show();
                                                });
                                            }
                                        } else {
                                            // See if we can fetch a full url (with no hash to target)
                                            // This is a special case and we should probably do some content thinning / targeting
                                            fetch(url)
                                            .then(res => res.text())
                                            .then(html => {
                                                const parser = new DOMParser();
                                                const htmlDoc = parser.parseFromString(html, "text/html");
                                                const note = htmlDoc.querySelector('main.content');
                                                if (note !== null) {
                                                    // This should only happen for chapter cross references
                                                    // (since there is no id in the URL)
                                                    // remove the first header
                                                    if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                                                        note.children[0].remove();
                                                    }
                                                    const html = processXRef(null, note);
                                                    instance.setContent(html);
                                                } 
                                            }).finally(() => {
                                                instance.enable();
                                                instance.show();
                                            });
                                        }
                                    }, function(instance) {
                                    });
                                }
                                let selectedAnnoteEl;
                                const selectorForAnnotation = ( cell, annotation) => {
                                    let cellAttr = 'data-code-cell="' + cell + '"';
                                    let lineAttr = 'data-code-annotation="' +  annotation + '"';
                                    const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
                                    return selector;
                                }
                                const selectCodeLines = (annoteEl) => {
                                    const doc = window.document;
                                    const targetCell = annoteEl.getAttribute("data-target-cell");
                                    const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
                                    const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
                                    const lines = annoteSpan.getAttribute("data-code-lines").split(",");
                                    const lineIds = lines.map((line) => {
                                        return targetCell + "-" + line;
                                    })
                                    let top = null;
                                    let height = null;
                                    let parent = null;
                                    if (lineIds.length > 0) {
                                        //compute the position of the single el (top and bottom and make a div)
                                        const el = window.document.getElementById(lineIds[0]);
                                        top = el.offsetTop;
                                        height = el.offsetHeight;
                                        parent = el.parentElement.parentElement;
                                        if (lineIds.length > 1) {
                                            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
                                            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
                                            height = bottom - top;
                                        }
                                        if (top !== null && height !== null && parent !== null) {
                                            // cook up a div (if necessary) and position it 
                                            let div = window.document.getElementById("code-annotation-line-highlight");
                                            if (div === null) {
                                                div = window.document.createElement("div");
                                                div.setAttribute("id", "code-annotation-line-highlight");
                                                div.style.position = 'absolute';
                                                parent.appendChild(div);
                                            }
                                            div.style.top = top - 2 + "px";
                                            div.style.height = height + 4 + "px";
                                            div.style.left = 0;
                                            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
                                            if (gutterDiv === null) {
                                                gutterDiv = window.document.createElement("div");
                                                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                                                gutterDiv.style.position = 'absolute';
                                                const codeCell = window.document.getElementById(targetCell);
                                                const gutter = codeCell.querySelector('.code-annotation-gutter');
                                                gutter.appendChild(gutterDiv);
                                            }
                                            gutterDiv.style.top = top - 2 + "px";
                                            gutterDiv.style.height = height + 4 + "px";
                                        }
                                        selectedAnnoteEl = annoteEl;
                                    }
                                };
                                const unselectCodeLines = () => {
                                    const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
                                    elementsIds.forEach((elId) => {
                                        const div = window.document.getElementById(elId);
                                        if (div) {
                                            div.remove();
                                        }
                                    });
                                    selectedAnnoteEl = undefined;
                                };
                                // Handle positioning of the toggle
                                window.addEventListener(
                                "resize",
                                throttle(() => {
                                    elRect = undefined;
                                    if (selectedAnnoteEl) {
                                        selectCodeLines(selectedAnnoteEl);
                                    }
                                }, 10)
                                );
                                function throttle(fn, ms) {
                                    let throttle = false;
                                    let timer;
                                    return (...args) => {
                                        if(!throttle) { // first call gets through
                                            fn.apply(this, args);
                                            throttle = true;
                                        } else { // all the others get throttled
                                            if(timer) clearTimeout(timer); // cancel #2
                                            timer = setTimeout(() => {
                                                fn.apply(this, args);
                                                timer = throttle = false;
                                            }, ms);
                                        }
                                    };
                                }
                                // Attach click handler to the DT
                                const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
                                for (const annoteDlNode of annoteDls) {
                                    annoteDlNode.addEventListener('click', (event) => {
                                        const clickedEl = event.target;
                                        if (clickedEl !== selectedAnnoteEl) {
                                            unselectCodeLines();
                                            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
                                            if (activeEl) {
                                                activeEl.classList.remove('code-annotation-active');
                                            }
                                            selectCodeLines(clickedEl);
                                            clickedEl.classList.add('code-annotation-active');
                                        } else {
                                            // Unselect the line
                                            unselectCodeLines();
                                            clickedEl.classList.remove('code-annotation-active');
                                        }
                                    });
                                }
                                const findCites = (el) => {
                                    const parentEl = el.parentElement;
                                    if (parentEl) {
                                        const cites = parentEl.dataset.cites;
                                        if (cites) {
                                            return {
                                                el,
                                                cites: cites.split(' ')
                                            };
                                        } else {
                                            return findCites(el.parentElement)
                                        }
                                    } else {
                                        return undefined;
                                    }
                                };
                                var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
                                for (var i=0; i<bibliorefs.length; i++) {
                                    const ref = bibliorefs[i];
                                    const citeInfo = findCites(ref);
                                    if (citeInfo) {
                                        tippyHover(citeInfo.el, function() {
                                            var popup = window.document.createElement('div');
                                            citeInfo.cites.forEach(function(cite) {
                                                var citeDiv = window.document.createElement('div');
                                                citeDiv.classList.add('hanging-indent');
                                                citeDiv.classList.add('csl-entry');
                                                var biblioDiv = window.document.getElementById('ref-' + cite);
                                                if (biblioDiv) {
                                                    citeDiv.innerHTML = biblioDiv.innerHTML;
                                                }
                                                popup.appendChild(citeDiv);
                                            });
                                            return popup.innerHTML;
                                        });
                                    }
                                }
                            });
                            
                            window.document.addEventListener("DOMContentLoaded", function (event) {
                                const toggleBodyColorMode = (bsSheetEl) => {
                                    const mode = bsSheetEl.getAttribute("data-mode");
                                    const bodyEl = window.document.querySelector("body");
                                    if (mode === "dark") {
                                        bodyEl.classList.add("quarto-dark");
                                        bodyEl.classList.remove("quarto-light");
                                    } else {
                                        bodyEl.classList.add("quarto-light");
                                        bodyEl.classList.remove("quarto-dark");
                                    }
                                }
                                const toggleBodyColorPrimary = () => {
                                    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
                                    if (bsSheetEl) {
                                        toggleBodyColorMode(bsSheetEl);
                                    }
                                }
                                toggleBodyColorPrimary();  
                                const icon = "";
                                const anchorJS = new window.AnchorJS();
                                anchorJS.options = {
                                    placement: 'right',
                                    icon: icon
                                };
                                anchorJS.add('.anchored');
                                const isCodeAnnotation = (el) => {
                                    for (const clz of el.classList) {
                                        if (clz.startsWith('code-annotation-')) {                     
                                            return true;
                                        }
                                    }
                                    return false;
                                }
                                const clipboard = new window.ClipboardJS('.code-copy-button', {
                                    text: function(trigger) {
                                        const codeEl = trigger.previousElementSibling.cloneNode(true);
                                        for (const childEl of codeEl.children) {
                                            if (isCodeAnnotation(childEl)) {
                                                childEl.remove();
                                            }
                                        }
                                        return codeEl.innerText;
                                    }
                                });
                                clipboard.on('success', function(e) {
                                    // button target
                                    const button = e.trigger;
                                    // don't keep focus
                                    button.blur();
                                    // flash "checked"
                                    button.classList.add('code-copy-button-checked');
                                    var currentTitle = button.getAttribute("title");
                                    button.setAttribute("title", "Copied!");
                                    let tooltip;
                                    if (window.bootstrap) {
                                        button.setAttribute("data-bs-toggle", "tooltip");
                                        button.setAttribute("data-bs-placement", "left");
                                        button.setAttribute("data-bs-title", "Copied!");
                                        tooltip = new bootstrap.Tooltip(button, 
                                        { trigger: "manual", 
                                        customClass: "code-copy-button-tooltip",
                                        offset: [0, -8]});
                                        tooltip.show();    
                                    }
                                    setTimeout(function() {
                                        if (tooltip) {
                                            tooltip.hide();
                                            button.removeAttribute("data-bs-title");
                                            button.removeAttribute("data-bs-toggle");
                                            button.removeAttribute("data-bs-placement");
                                        }
                                        button.setAttribute("title", currentTitle);
                                        button.classList.remove('code-copy-button-checked');
                                    }, 1000);
                                    // clear code selection
                                    e.clearSelection();
                                });
                                function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
                                    const config = {
                                        allowHTML: true,
                                        maxWidth: 500,
                                        delay: 100,
                                        arrow: false,
                                        appendTo: function(el) {
                                            return el.parentElement;
                                        },
                                        interactive: true,
                                        interactiveBorder: 10,
                                        theme: 'quarto',
                                        placement: 'bottom-start',
                                    };
                                    if (contentFn) {
                                        config.content = contentFn;
                                    }
                                    if (onTriggerFn) {
                                        config.onTrigger = onTriggerFn;
                                    }
                                    if (onUntriggerFn) {
                                        config.onUntrigger = onUntriggerFn;
                                    }
                                    window.tippy(el, config); 
                                }
                                const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
                                for (var i=0; i<noterefs.length; i++) {
                                    const ref = noterefs[i];
                                    tippyHover(ref, function() {
                                        // use id or data attribute instead here
                                        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
                                        try { href = new URL(href).hash; } catch {}
                                        const id = href.replace(/^#\/?/, "");
                                        const note = window.document.getElementById(id);
                                        return note.innerHTML;
                                    });
                                }
                                const xrefs = window.document.querySelectorAll('a.quarto-xref');
                                const processXRef = (id, note) => {
                                    // Strip column container classes
                                    const stripColumnClz = (el) => {
                                        el.classList.remove("page-full", "page-columns");
                                        if (el.children) {
                                            for (const child of el.children) {
                                                stripColumnClz(child);
                                            }
                                        }
                                    }
                                    stripColumnClz(note)
                                    if (id === null || id.startsWith('sec-')) {
                                        // Special case sections, only their first couple elements
                                        const container = document.createElement("div");
                                        if (note.children && note.children.length > 2) {
                                            container.appendChild(note.children[0].cloneNode(true));
                                            for (let i = 1; i < note.children.length; i++) {
                                                const child = note.children[i];
                                                if (child.tagName === "P" && child.innerText === "") {
                                                    continue;
                                                } else {
                                                    container.appendChild(child.cloneNode(true));
                                                    break;
                                                }
                                            }
                                            if (window.Quarto?.typesetMath) {
                                                window.Quarto.typesetMath(container);
                                            }
                                            return container.innerHTML
                                        } else {
                                            if (window.Quarto?.typesetMath) {
                                                window.Quarto.typesetMath(note);
                                            }
                                            return note.innerHTML;
                                        }
                                    } else {
                                        // Remove any anchor links if they are present
                                        const anchorLink = note.querySelector('a.anchorjs-link');
                                        if (anchorLink) {
                                            anchorLink.remove();
                                        }
                                        if (window.Quarto?.typesetMath) {
                                            window.Quarto.typesetMath(note);
                                        }
                                        // TODO in 1.5, we should make sure this works without a callout special case
                                        if (note.classList.contains("callout")) {
                                            return note.outerHTML;
                                        } else {
                                            return note.innerHTML;
                                        }
                                    }
                                }
                                for (var i=0; i<xrefs.length; i++) {
                                    const xref = xrefs[i];
                                    tippyHover(xref, undefined, function(instance) {
                                        instance.disable();
                                        let url = xref.getAttribute('href');
                                        let hash = undefined; 
                                        if (url.startsWith('#')) {
                                            hash = url;
                                        } else {
                                            try { hash = new URL(url).hash; } catch {}
                                        }
                                        if (hash) {
                                            const id = hash.replace(/^#\/?/, "");
                                            const note = window.document.getElementById(id);
                                            if (note !== null) {
                                                try {
                                                    const html = processXRef(id, note.cloneNode(true));
                                                    instance.setContent(html);
                                                } finally {
                                                    instance.enable();
                                                    instance.show();
                                                }
                                            } else {
                                                // See if we can fetch this
                                                fetch(url.split('#')[0])
                                                .then(res => res.text())
                                                .then(html => {
                                                    const parser = new DOMParser();
                                                    const htmlDoc = parser.parseFromString(html, "text/html");
                                                    const note = htmlDoc.getElementById(id);
                                                    if (note !== null) {
                                                        const html = processXRef(id, note);
                                                        instance.setContent(html);
                                                    } 
                                                }).finally(() => {
                                                    instance.enable();
                                                    instance.show();
                                                });
                                            }
                                        } else {
                                            // See if we can fetch a full url (with no hash to target)
                                            // This is a special case and we should probably do some content thinning / targeting
                                            fetch(url)
                                            .then(res => res.text())
                                            .then(html => {
                                                const parser = new DOMParser();
                                                const htmlDoc = parser.parseFromString(html, "text/html");
                                                const note = htmlDoc.querySelector('main.content');
                                                if (note !== null) {
                                                    // This should only happen for chapter cross references
                                                    // (since there is no id in the URL)
                                                    // remove the first header
                                                    if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                                                        note.children[0].remove();
                                                    }
                                                    const html = processXRef(null, note);
                                                    instance.setContent(html);
                                                } 
                                            }).finally(() => {
                                                instance.enable();
                                                instance.show();
                                            });
                                        }
                                    }, function(instance) {
                                    });
                                }
                                let selectedAnnoteEl;
                                const selectorForAnnotation = ( cell, annotation) => {
                                    let cellAttr = 'data-code-cell="' + cell + '"';
                                    let lineAttr = 'data-code-annotation="' +  annotation + '"';
                                    const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
                                    return selector;
                                }
                                const selectCodeLines = (annoteEl) => {
                                    const doc = window.document;
                                    const targetCell = annoteEl.getAttribute("data-target-cell");
                                    const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
                                    const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
                                    const lines = annoteSpan.getAttribute("data-code-lines").split(",");
                                    const lineIds = lines.map((line) => {
                                        return targetCell + "-" + line;
                                    })
                                    let top = null;
                                    let height = null;
                                    let parent = null;
                                    if (lineIds.length > 0) {
                                        //compute the position of the single el (top and bottom and make a div)
                                        const el = window.document.getElementById(lineIds[0]);
                                        top = el.offsetTop;
                                        height = el.offsetHeight;
                                        parent = el.parentElement.parentElement;
                                        if (lineIds.length > 1) {
                                            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
                                            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
                                            height = bottom - top;
                                        }
                                        if (top !== null && height !== null && parent !== null) {
                                            // cook up a div (if necessary) and position it 
                                            let div = window.document.getElementById("code-annotation-line-highlight");
                                            if (div === null) {
                                                div = window.document.createElement("div");
                                                div.setAttribute("id", "code-annotation-line-highlight");
                                                div.style.position = 'absolute';
                                                parent.appendChild(div);
                                            }
                                            div.style.top = top - 2 + "px";
                                            div.style.height = height + 4 + "px";
                                            div.style.left = 0;
                                            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
                                            if (gutterDiv === null) {
                                                gutterDiv = window.document.createElement("div");
                                                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                                                gutterDiv.style.position = 'absolute';
                                                const codeCell = window.document.getElementById(targetCell);
                                                const gutter = codeCell.querySelector('.code-annotation-gutter');
                                                gutter.appendChild(gutterDiv);
                                            }
                                            gutterDiv.style.top = top - 2 + "px";
                                            gutterDiv.style.height = height + 4 + "px";
                                        }
                                        selectedAnnoteEl = annoteEl;
                                    }
                                };
                                const unselectCodeLines = () => {
                                    const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
                                    elementsIds.forEach((elId) => {
                                        const div = window.document.getElementById(elId);
                                        if (div) {
                                            div.remove();
                                        }
                                    });
                                    selectedAnnoteEl = undefined;
                                };
                                // Handle positioning of the toggle
                                window.addEventListener(
                                "resize",
                                throttle(() => {
                                    elRect = undefined;
                                    if (selectedAnnoteEl) {
                                        selectCodeLines(selectedAnnoteEl);
                                    }
                                }, 10)
                                );
                                function throttle(fn, ms) {
                                    let throttle = false;
                                    let timer;
                                    return (...args) => {
                                        if(!throttle) { // first call gets through
                                            fn.apply(this, args);
                                            throttle = true;
                                        } else { // all the others get throttled
                                            if(timer) clearTimeout(timer); // cancel #2
                                            timer = setTimeout(() => {
                                                fn.apply(this, args);
                                                timer = throttle = false;
                                            }, ms);
                                        }
                                    };
                                }
                                // Attach click handler to the DT
                                const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
                                for (const annoteDlNode of annoteDls) {
                                    annoteDlNode.addEventListener('click', (event) => {
                                        const clickedEl = event.target;
                                        if (clickedEl !== selectedAnnoteEl) {
                                            unselectCodeLines();
                                            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
                                            if (activeEl) {
                                                activeEl.classList.remove('code-annotation-active');
                                            }
                                            selectCodeLines(clickedEl);
                                            clickedEl.classList.add('code-annotation-active');
                                        } else {
                                            // Unselect the line
                                            unselectCodeLines();
                                            clickedEl.classList.remove('code-annotation-active');
                                        }
                                    });
                                }
                                const findCites = (el) => {
                                    const parentEl = el.parentElement;
                                    if (parentEl) {
                                        const cites = parentEl.dataset.cites;
                                        if (cites) {
                                            return {
                                                el,
                                                cites: cites.split(' ')
                                            };
                                        } else {
                                            return findCites(el.parentElement)
                                        }
                                    } else {
                                        return undefined;
                                    }
                                };
                                var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
                                for (var i=0; i<bibliorefs.length; i++) {
                                    const ref = bibliorefs[i];
                                    const citeInfo = findCites(ref);
                                    if (citeInfo) {
                                        tippyHover(citeInfo.el, function() {
                                            var popup = window.document.createElement('div');
                                            citeInfo.cites.forEach(function(cite) {
                                                var citeDiv = window.document.createElement('div');
                                                citeDiv.classList.add('hanging-indent');
                                                citeDiv.classList.add('csl-entry');
                                                var biblioDiv = window.document.getElementById('ref-' + cite);
                                                if (biblioDiv) {
                                                    citeDiv.innerHTML = biblioDiv.innerHTML;
                                                }
                                                popup.appendChild(citeDiv);
                                            });
                                            return popup.innerHTML;
                                        });
                                    }
                                }
                            });
                        </script>
                    </div> <!-- /content -->
                </body></html>
                